{% extends 'associations/detail.html' %}

{% load rules %}

{% block menu %}{% menu 'conversation' association.entity %}{% endblock %}
{% block heading_title %}{% with title='Gespr√§ch' %}{{ block.super }}{% endwith %}{% endblock %}

{% block content %}
    {% has_perm 'conversations.reply' user association as can_reply %}
    
    <div class="conversation" data-component="conversation" id="{% ref association.container %}">
        <header class="conversation-header">
            <h1 class="content-title">
                {{ association.container.subject }}
            </h1>
        </header>

        <div class="conversation-body">
            <ol class="medias">
                {% for message in association.container.texts.all %}
                    <li>
                        {% include 'texts/_text.html' with text=message only %}
                    </li>
                {% endfor %}
                {% if can_reply %}
                <li>
                    {% include "conversations/_reply.html" with form=form author=user.gestalt %}
                </li>
                {% endif %}
            </ol>
        </div>
    </div>
{% endblock %}
